<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"
    />
    <title>ìƒˆê°€ë‚˜ì•ˆêµíšŒ í•˜ê°€ë‹¤</title>
    <style>
      /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ ì´ˆê¸°í™” */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      /* ì „ì²´ í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
      body {
        font-family: "Arial", sans-serif;
        text-align: center;
        display: flex;
        flex-direction: column;
        height: 100vh;
      }

      /* ë‚ ì§œ ì œëª© ìŠ¤íƒ€ì¼ */
      h2 {
        margin: 10px 0;
        font-size: 3vw;
      }

      /* ë§ì”€ ì˜ì—­ ìŠ¤íƒ€ì¼ */
      #verse-container {
        flex: 1; /* í™”ë©´ì˜ ë‚¨ì€ ê³µê°„ì„ ëª¨ë‘ ì°¨ì§€ */
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100%;
        height: auto; /* ë†’ì´ë¥¼ ìë™ìœ¼ë¡œ ì„¤ì • */
      }

      iframe {
        width: 100%;
        height: 100%;
        border: none;
      }

      /* ì¹´ìš´í„° ìŠ¤íƒ€ì¼ */
      #counter {
        font-size: 50px;
        margin-bottom: 20px;
        z-index: 10;
      }

      /* ë²„íŠ¼ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
      .button-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
        position: fixed;
        bottom: 0;
        width: 100%;
        background: white;
      }

      /* ë²„íŠ¼ í–‰ ìŠ¤íƒ€ì¼ */
      .button-row {
        display: flex;
        justify-content: center;
        gap: 0.5rem; /* ë²„íŠ¼ ê°„ê²© */
        flex-wrap: nowrap; /* ë²„íŠ¼ì´ í•œ ì¤„ì— ìœ ì§€ë˜ë„ë¡ ì„¤ì • */
        margin-bottom: 1rem;
        width: 100%; /* ë²„íŠ¼ í–‰ì´ ê°€ë¡œí­ì„ ê½‰ ì±„ìš°ë„ë¡ ì„¤ì • */
      }

      /* ê³µí†µ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
      button {
        font-size: 1.25rem; /* ê¸€ê¼´ í¬ê¸°ë¥¼ rem ë‹¨ìœ„ë¡œ ì„¤ì • */
        padding: 0.5rem 1rem; /* ë‚´ë¶€ ì—¬ë°±ì„ rem ë‹¨ìœ„ë¡œ ì„¤ì • */
        flex: 1; /* ë²„íŠ¼ì´ ë™ì¼í•œ ë„ˆë¹„ë¥¼ ê°€ì§€ë„ë¡ ì„¤ì • */
        height: auto; /* ë²„íŠ¼ ë†’ì´ë¥¼ ìë™ìœ¼ë¡œ ì¡°ì • */
        cursor: pointer;
        border: none;
        border-radius: 25px; /* ì™„ì „íˆ ë‘¥ê·¼ ëª¨ì„œë¦¬ */
        box-shadow: inset 0 -3px 5px rgba(0, 0, 0, 0.2),
          /* ë‚´ë¶€ ê·¸ë¦¼ì */ 0 4px 6px rgba(0, 0, 0, 0.3); /* ì™¸ë¶€ ê·¸ë¦¼ì */
        color: white; /* í…ìŠ¤íŠ¸ ìƒ‰ìƒ */
        font-weight: bold;
        text-shadow: 0 1px rgba(0, 0, 0, 0.2); /* í…ìŠ¤íŠ¸ ê·¸ë¦¼ì íš¨ê³¼ */
        transition: all 0.2s ease; /* ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ */
        position: relative; /* ê´‘íƒ íš¨ê³¼ë¥¼ ìœ„í•œ ìƒëŒ€ ìœ„ì¹˜ */
        overflow: hidden; /* ê´‘íƒ íš¨ê³¼ê°€ ë²„íŠ¼ ì˜ì—­ì„ ë²—ì–´ë‚˜ì§€ ì•Šë„ë¡ ì„¤ì • */
        touch-action: manipulation;
      }

      /* ë°˜ì‘í˜• ìŠ¤íƒ€ì¼ */
      @media (max-width: 390px) {
        button {
          font-size: 1rem; /* ì‘ì€ í™”ë©´ì—ì„œëŠ” ê¸€ê¼´ í¬ê¸° ì¤„ì´ê¸° */
          padding: 0.4rem 0.8rem;
        }

        .button-row {
          gap: 0.3rem; /* ë²„íŠ¼ ê°„ê²© ì¤„ì´ê¸° */
        }
      }

      /* ì˜ë¬¸ ë²„íŠ¼ (íŒŒë€ìƒ‰) */
      .toggle-lang {
        background: linear-gradient(
          to bottom,
          #2196f3,
          #1e88e5
        ); /* íŒŒë€ìƒ‰ ê·¸ë¼ë°ì´ì…˜ */
      }

      /* ë¦¬ì…‹ ë²„íŠ¼ (ë¹¨ê°„ìƒ‰) */
      .reset {
        background: linear-gradient(
          to bottom,
          #f44336,
          #e53935
        ); /* ë¹¨ê°„ìƒ‰ ê·¸ë¼ë°ì´ì…˜ */
      }

      /* +1 ë²„íŠ¼ (ì´ˆë¡ìƒ‰) */
      .increase {
        background: linear-gradient(
          to bottom,
          #4caf50,
          #45a049
        ); /* ì´ˆë¡ìƒ‰ ê·¸ë¼ë°ì´ì…˜ */
      }

      /* ê°€ë¦¬ê¸° ë²„íŠ¼ (íšŒìƒ‰) */
      .hide-verse {
        background: linear-gradient(
          to bottom,
          #9e9e9e,
          #757575
        ); /* íšŒìƒ‰ ê·¸ë¼ë°ì´ì…˜ */
      }

      /* ë²„íŠ¼ í´ë¦­ íš¨ê³¼ */
      button:active {
        transform: translateY(2px); /* í´ë¦­ ì‹œ ëˆŒë¦¬ëŠ” íš¨ê³¼ */
        box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.2),
          0 2px 4px rgba(0, 0, 0, 0.3); /* í´ë¦­ ì‹œ ê·¸ë¦¼ì ì¤„ì´ê¸° */
      }

      /* ë¶ˆê½ƒë†€ì´ íš¨ê³¼ ìŠ¤íƒ€ì¼ */
      .firework {
        position: fixed;
        top: 50%;
        left: 50%;
        width: 10px;
        height: 10px;
        background-color: red;
        border-radius: 50%;
        animation: explode 1s ease-out forwards;
        pointer-events: none;
      }

      @keyframes explode {
        0% {
          transform: scale(1) translate(-50%, -50%);
          opacity: 1;
        }
        100% {
          transform: scale(50) translate(-50%, -50%);
          opacity: 0;
        }
      }

      /* í’ì„  ìŠ¤íƒ€ì¼ */
      .balloon {
        position: fixed;
        bottom: -100px;
        width: 50px;
        height: 70px;
        background-color: red;
        border-radius: 50%;
        animation: floatUp 5s ease-in forwards;
        z-index: 1000;
      }

      #date-container {
        display: flex;
        justify-content: center; /* ê°€ë¡œ ì¤‘ì•™ ì •ë ¬ */
        align-items: center; /* ì„¸ë¡œ ì¤‘ì•™ ì •ë ¬ */
        text-align: center; /* ë‚´ë¶€ í…ìŠ¤íŠ¸ë„ ì¤‘ì•™ ì •ë ¬ */
        gap: 10px; /* ë‚ ì§œì™€ ì¹­í˜¸ ì‚¬ì´ ê°„ê²© */
        width: 100%; /* ì „ì²´ ë„ˆë¹„ ì‚¬ìš© */
      }

      #title-badge {
        font-size: 1em; /* ë‚ ì§œì™€ ë™ì¼í•œ í¬ê¸° */
        font-weight: bold;
        color: darkblue;
        white-space: nowrap; /* ì¹­í˜¸ê°€ ì¤„ ë°”ê¿ˆë˜ì§€ ì•Šë„ë¡ ì„¤ì • */
      }

      @keyframes floatUp {
        0% {
          transform: translateX(0) translateY(0);
          opacity: 1;
        }
        100% {
          transform: translateX(calc(100vw - 50px)) translateY(-100vh);
          opacity: 0;
        }
      }

      /* ë°°ê²½ìƒ‰ ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ */
      @keyframes backgroundFlash {
        0% {
          background-color: white;
        }
        25% {
          background-color: lightblue;
        }
        50% {
          background-color: lightgreen;
        }
        75% {
          background-color: lightpink;
        }
        100% {
          background-color: white;
        }
      }

      .background-flash {
        animation: backgroundFlash 3s ease-in-out;
      }
    </style>
  </head>
  <body>
    <div id="date-container">
      <h2 id="date"></h2>
      <span id="title-badge"></span>
    </div>

    <!-- ë§ì”€ ì˜ì—­ -->
    <div id="verse-container">
      <iframe id="verse-frame"></iframe>
    </div>

    <!-- ë²„íŠ¼ ë° ì¹´ìš´í„° ì˜ì—­ -->
    <div class="button-container">
      <div id="counter">0</div>
      <div class="button-row">
        <!--<button class="share-kakao" onclick="shareToKakao()">ê³µìœ </button>    -->
        <button class="reset" onclick="resetCounter()">ë¦¬ì…‹</button>
        <button class="toggle-lang" onclick="toggleLanguage()">ì˜ë¬¸</button>
        <button class="hide-verse" onclick="toggleVerse()">ê°€ë¦¬ê¸°</button>
      </div>
      <div class="button-row">
        <button class="increase" onclick="increaseCounter()">+1</button>
      </div>
    </div>

    <script>
      const titles = [
        "ğŸŒ± ìƒˆì‹¹", // 1~19ë²ˆ
        "â­ ë§ì”€ ì§€í‚´ì´", // 20~39ë²ˆ
        "ğŸ”¥ ì‹ ì•™ì˜ ë¶ˆê½ƒ", // 40~59ë²ˆ
        "ğŸ’ ë¯¿ìŒì˜ ë³´ì„", // 60~79ë²ˆ
        "ğŸŒŸ ë¹›ì˜ ì¦ì¸", // 80~99ë²ˆ
        "ğŸ† ë§ì”€ì˜ ì±”í”¼ì–¸", // 100ë²ˆ ì´ìƒ
      ];

      let count = 0;
      let isKorean = true; // í˜„ì¬ ì–¸ì–´ ìƒíƒœ (true: í•œê¸€, false: ì˜ë¬¸)
      let isVerseHidden = false;

      // ì¹­í˜¸ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
      function updateTitleBadge(count) {
        let titleIndex = Math.floor(count / 20);
        if (titleIndex >= titles.length) titleIndex = titles.length - 1;
        document.getElementById("title-badge").innerText = titles[titleIndex];
      }

      // ë§ì”€ ê°€ë¦¬ê¸°/ë³´ì´ê¸° í•¨ìˆ˜
      function toggleVerse() {
        const verseContainer = document.getElementById("verse-container");
        const hideVerseButton = document.querySelector(".hide-verse");

        if (isVerseHidden) {
          verseContainer.style.display = "flex";
          if (isKorean) hideVerseButton.innerText = "ê°€ë¦¬ê¸°";
          else hideVerseButton.innerText = "Hide";
          isVerseHidden = false;
        } else {
          verseContainer.style.display = "none";
          if (isKorean) hideVerseButton.innerText = "ë³´ì´ê¸°";
          else hideVerseButton.innerText = "Show";
          isVerseHidden = true;
        }
      }

      // ì¹´ì¹´ì˜¤í†¡ ê³µìœ  í•¨ìˆ˜
      function shareToKakao() {
        html2canvas(document.body).then((canvas) => {
          const imageData = canvas.toDataURL("image/png");

          // ì¹´ì¹´ì˜¤í†¡ ê³µìœ  ìŠ¤í¬ë¦½íŠ¸
          Kakao.init("YOUR_KAKAO_APP_KEY"); // ì¹´ì¹´ì˜¤ ì•± í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”
          Kakao.Link.sendDefault({
            objectType: "feed",
            content: {
              title: "í•˜ê°€ë‹¤ ë§ì”€",
              description: "ì˜¤ëŠ˜ì˜ ë§ì”€ì„ ê³µìœ í•©ë‹ˆë‹¤.",
              imageUrl: imageData,
              link: {
                mobileWebUrl: window.location.href,
                webUrl: window.location.href,
              },
            },
          });
        });
      }
      // ë‚ ì§œ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
      function updateDate() {
        const today = new Date();
        const formattedDate =
          today.getFullYear() +
          "ë…„ " +
          (today.getMonth() + 1) +
          "ì›” " +
          today.getDate() +
          "ì¼";
        document.getElementById("date").innerText = formattedDate;
        return formattedDate;
      }

      // ë§ì”€ ë¡œë“œ í•¨ìˆ˜
      function loadVerse() {
        const timestamp = new Date().getTime();
        const language = isKorean ? "verse_ko.html" : "verse_en.html"; // ì–¸ì–´ì— ë”°ë¼ íŒŒì¼ ì„ íƒ
        document.getElementById(
          "verse-frame"
        ).src = `${language}?t=${timestamp}`;
      }

      // ì¹´ìš´í„° ë¡œë“œ í•¨ìˆ˜
      function loadCounter() {
        const savedDate = localStorage.getItem("savedDate");
        const savedCount = localStorage.getItem("counter");

        const currentDate = updateDate();

        if (savedDate === currentDate && savedCount !== null) {
          count = parseInt(savedCount, 10);
        } else {
          count = 0;
          localStorage.setItem("savedDate", currentDate);
        }
        document.getElementById("counter").innerText = count;

        updateTitleBadge(count);
      }

      function flashBackground() {
        document.body.classList.add("background-flash");

        // 3ì´ˆ í›„ í´ë˜ìŠ¤ ì œê±°
        setTimeout(() => {
          document.body.classList.remove("background-flash");
        }, 3000);
      }
      function releaseBalloons() {
        for (let i = 0; i < 10; i++) {
          setTimeout(() => {
            const balloon = document.createElement("div");
            balloon.classList.add("balloon");

            // ëœë¤ ìƒ‰ìƒ
            const colors = ["red", "blue", "green", "yellow", "purple"];
            balloon.style.backgroundColor =
              colors[Math.floor(Math.random() * colors.length)];

            // ëœë¤ ìœ„ì¹˜
            balloon.style.left = `${Math.random() * 100}vw`;

            document.body.appendChild(balloon);

            // 5ì´ˆ í›„ í’ì„  ì œê±°
            setTimeout(() => {
              balloon.remove();
            }, 5000);
          }, i * 300); // í’ì„ ì´ ìˆœì°¨ì ìœ¼ë¡œ ë‚˜íƒ€ë‚˜ë„ë¡ ë”œë ˆì´ ì¶”ê°€
        }
      }
      // ì¹´ìš´í„° ì¦ê°€ í•¨ìˆ˜
      function increaseCounter() {
        count++;
        document.getElementById("counter").innerText = count;
        localStorage.setItem("counter", count);

        // 20ë²ˆ ë‹¨ìœ„ë¡œ ì¹­í˜¸ ì—…ë°ì´íŠ¸
        updateTitleBadge(count);

        // 10ì˜ ë°°ìˆ˜ì¼ ë•Œ ë¶ˆê½ƒë†€ì´ íš¨ê³¼ ì‹¤í–‰
        if (count % 10 === 0) {
          triggerFirework();
        }

        // 100ë²ˆ ë‹¬ì„± ì‹œ íŠ¹ë³„ íš¨ê³¼ ì‹¤í–‰
        if (count === 100) {
          triggerFirework();
          flashBackground();
          releaseBalloons();
        }
      }

      // ë¶ˆê½ƒë†€ì´ íš¨ê³¼ í•¨ìˆ˜
      function triggerFirework() {
        const firework = document.createElement("div");
        firework.classList.add("firework");

        // ëœë¤ ìƒ‰ìƒ ìƒì„±
        const randomColor = `hsl(${Math.random() * 360}, 100%, 50%)`;
        firework.style.backgroundColor = randomColor;

        document.body.appendChild(firework);

        // 1ì´ˆ í›„ ë¶ˆê½ƒë†€ì´ ìš”ì†Œ ì œê±°
        setTimeout(() => {
          firework.remove();
        }, 1000);
      }

      // ì¹´ìš´í„° ë¦¬ì…‹ í•¨ìˆ˜
      function resetCounter() {
        count = 0;
        document.getElementById("counter").innerText = count;
        localStorage.setItem("counter", count);
        updateTitleBadge(count);

        location.reload();
      }

      // ì–¸ì–´ ì „í™˜ í•¨ìˆ˜
      function toggleLanguage() {
        const toggleLangButton = document.querySelector(".toggle-lang");
        const resetButton = document.querySelector(".reset");
        const hideVerseButton = document.querySelector(".hide-verse");

        if (isKorean) {
          toggleLangButton.innerText = "Korean";
          resetButton.innerText = "Reset";
          if (isVerseHidden) hideVerseButton.innerText = "Show";
          else hideVerseButton.innerText = "Hide";
          isKorean = false;
        } else {
          toggleLangButton.innerText = "ì˜ë¬¸";
          resetButton.innerText = "ë¦¬ì…‹";
          if (isVerseHidden) hideVerseButton.innerText = "ë³´ì´ê¸°";
          else hideVerseButton.innerText = "ê°€ë¦¬ê¸°";
          isKorean = true;
        }

        // ë§ì”€ íŒŒì¼ ë‹¤ì‹œ ë¡œë“œ
        loadVerse();
      }

      // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
      window.onload = function () {
        loadVerse();
        loadCounter();
      };
    </script>
  </body>
</html>
